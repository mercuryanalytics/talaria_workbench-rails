"use strict";window.define(["module"],function(e){function t(e){var t=/^(?:urn:)?talaria:(question|project):/,n=t.exec(e);if(!n)throw new TypeError("Talaria URN required");var r=e.substr(n.index+n[0].length),o=d.authority;return window.fetch(""+o+("api/questions/"+r),{mode:"cors",credentials:"include",headers:{Accept:"application/json"}}).then(function(e){return e.json()}).then(function(e){return new s(e)})}var n=function(e,t){return e.__proto__={a:t},e.a===t}({},{}),r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,i=function(e,t){for(var n in t)t.hasOwnProperty(n)&&r(e,n,o(t,n));return e},u=Object.setPrototypeOf||function(e,t){return n?e.__proto__=t:r(e,"__proto__",{value:t,configurable:!0,enumerable:!1,writable:!0}),e},a=Object.create;Array.prototype.find||(Array.prototype.find=function(e){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),r=n.length>>>0,o=arguments[1],i=0;r>i;i++)if(t=n[i],e.call(o,t,i,n))return t;return void 0});var s=function(){function e(e){var t=this;this.schema=[],e.schema&&(this.schema=e.schema.map(function(e){return l.create(t,e)})),this.respondents=[],e.respondents&&(this.respondents=e.respondents.map(function(e){return new g(t,e)})),this.disableStaticWeights=!1}var t={};return r(e,"prototype",{configurable:!1,enumerable:!1,writable:!1}),t.discard=function(){this.respondents=[],this.schema=[]},i(e.prototype,t),t=void 0,e}(),l=function(){function e(e,t){this.dataset=e,this.type=t.type,this.name=t.name,this.key=Symbol(t.name)}var t={},n={};return t.create=function(e,t){switch(t.type){case"categorical":return new c(e,t);case"multipunch":return new p(e,t);case"text":return new f(e,t);case"m2m":return new h(e,t);case"text_highlight":return new b(e,t);case"spotlight":return new y(e,t);default:throw new TypeError("Unknown type "+t.type)}},r(e,"prototype",{configurable:!1,enumerable:!1,writable:!1}),n.store=function(e,t){return e[this.key]=t,e},n.lookup=function(e){return this.interpret(e[this.key])},n.interpret=function(e){return e},i(e,t),i(e.prototype,n),t=n=void 0,e}(),c=function(e){function t(t,n){e.call(this,t,n),this._categories=n.categories}function o(){return this._categories}n||i(t,e);var s={};return null!==e&&u(t,e),t.prototype=a(null!==e?e.prototype:null,{constructor:{value:t,configurable:!0,writable:!0},categories:{get:o,configurable:!0,enumerable:!0}}),r(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),s.interpret=function(e){return this.categories[e]},i(t.prototype,s),s=void 0,t}(l),p=function(e){function t(){null!==e&&e.apply(this,arguments)}return n||i(t,e),null!==e&&u(t,e),t.prototype=a(null!==e?e.prototype:null,{constructor:{value:t,configurable:!0,writable:!0}}),r(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),t}(c),f=function(e){function t(){null!==e&&e.apply(this,arguments)}return n||i(t,e),null!==e&&u(t,e),t.prototype=a(null!==e?e.prototype:null,{constructor:{value:t,configurable:!0,writable:!0}}),r(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),t}(l),h=function(e){function t(){null!==e&&e.apply(this,arguments)}function o(){}function s(){}return n||i(t,e),null!==e&&u(t,e),t.prototype=a(null!==e?e.prototype:null,{constructor:{value:t,configurable:!0,writable:!0},labels:{get:o,configurable:!0,enumerable:!0},buttons:{get:s,configurable:!0,enumerable:!0}}),r(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),t}(l),b=function(e){function t(){null!==e&&e.apply(this,arguments)}function o(){}return n||i(t,e),null!==e&&u(t,e),t.prototype=a(null!==e?e.prototype:null,{constructor:{value:t,configurable:!0,writable:!0},copy:{get:o,configurable:!0,enumerable:!0}}),r(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),t}(l),y=function(e){function t(){null!==e&&e.apply(this,arguments)}function o(){}return n||i(t,e),null!==e&&u(t,e),t.prototype=a(null!==e?e.prototype:null,{constructor:{value:t,configurable:!0,writable:!0},image:{get:o,configurable:!0,enumerable:!0}}),r(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),t}(l),g=function(){function e(e,t){this.dataset=e,this.rid=t.rid,this.staticWeight=t.weight,this.dynamicWeight=1,this.responses=[],t.responses&&(this.responses=t.responses.reduce(function(t,n){return e.schema[n.k].store(t,n.v)},{}))}function t(){return this.dataset&&this.dataset.disableStaticWeights?this.dynamicWeight:this.staticWeight*this.dynamicWeight}var n=Object.defineProperties,o={};return n(e.prototype,{weight:{get:t,configurable:!0,enumerable:!0}}),r(e,"prototype",{configurable:!1,enumerable:!1,writable:!1}),o.response=function(e){return this.responses[e.name]},o.getResponseValue=function(e){var t=this.dataset.schema.find(function(t){return t.name===e});return t?t.lookup(this.responses):null},i(e.prototype,o),o=void 0,e}(),d=function(e){var t=e.lastIndexOf("/")+1,n=e.substr(t);e=e.substr(0,t),t=e.indexOf("/")+1,t=e.indexOf("/",t)+1,t=e.indexOf("/",t)+1;var r=e.substr(0,t),o=e.substr(t);return{authority:r,path:o,resource:n}}(e.uri);return t});